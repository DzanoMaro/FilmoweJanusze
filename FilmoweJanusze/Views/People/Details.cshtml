@model FilmoweJanusze.ViewModels.MovieandCast

@{
    ViewBag.Title = Model.People.FullName;

    string coll_biography_in = null;
    string coll_cast_in = null;
    string coll_director_in = null;
    string coll_gallery_in = null;
    string deleteclass = null;
    string padding = null;

    if (!String.IsNullOrEmpty(Model.People.Biography))
    {
        coll_biography_in = "in";
    }

    if (Model.Cast.Count > 0)
    {
        coll_cast_in = "in";
    }

    if (Model.DirectedMovies.Count > 0)
    {
        coll_director_in = "in";
    }

    if (Model.Photos.Count > 0)
    {
        coll_gallery_in = "in";
    }

    if (!User.IsInRole("Admin"))
    {
        deleteclass = "disabled";
    }

    if (User.IsInRole("Admin") || User.IsInRole("User"))
    {
        padding = "padding-top:8px";
    }
}

<!--NAGŁÓWEK-->
<div class="page-header well-jm">
    <div class="col-xs-11">
        <h3>
            @ViewBag.Title
        </h3>
    </div>
    @if (User.IsInRole("User") || User.IsInRole("Admin"))
    {
        <div class="dropdown col-xs-1 dropdownbutton">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                <i class="glyphicon glyphicon-menu-down"></i>
            </button>
            <ul class="dropdown-menu">
                <li>@Html.ActionLink("Edytuj", "Edit", new { id = Model.People.PeopleID })</li>
                <li class=@deleteclass>@Html.ActionLink("Usuń", "Delete", new { id = Model.People.PeopleID }, new { data_toggle = "tooltip", title = "Tylko admin może usuwać filmy!" })</li>
            </ul>
        </div>
    }
    <div class="clearfix"></div>
</div>

<!--DANE PERSONALNE-->
<div class="movieinfo">
    <div class="col-xs-8 col-lg-9 nopadding">
        <!--ZDJECIE-->
        <div class="col-xs-4 col-lg-3 movieinfo">
            @if (Model.People.FacePhoto != null)
            {
                <img class="img-responsive" src="@Url.Action("GetImage", "People", new { Model.People.PeopleID })" />
            }
            else
            {
                <img class="img-responsive" src="~/Images/Brak_zdjecia.png" />
            }
        </div>

        <!--DANE-->
        <div class="col-xs-8 movieinfo">
            <dl class="dl-horizontal">

                @if (!String.IsNullOrEmpty(Model.People.FirstName))
                {
                    <dt>@Html.DisplayNameFor(model => model.People.FirstName)</dt>
                    <dd>@Html.DisplayFor(model => model.People.FirstName)</dd>
                }

                @if (!String.IsNullOrEmpty(Model.People.LastName))
                {
                    <dt>@Html.DisplayNameFor(model => model.People.LastName)</dt>
                    <dd>@Html.DisplayFor(model => model.People.LastName)</dd>
                }

                @if (Model.People.Birthdate != null)
                {
                    <dt>@Html.DisplayNameFor(model => model.People.Birthdate)</dt>
                    <dd>
                        @Html.DisplayFor(model => model.People.Birthdate)
                        @if (!String.IsNullOrEmpty(Model.People.Age))
                        {
                            @:(@Html.DisplayFor(model => model.People.Age))
                        }
                    </dd>
                }

                @if (!String.IsNullOrEmpty(Model.People.Birthplace))
                {
                    <dt>@Html.DisplayNameFor(model => model.People.Birthplace)</dt>
                    <dd>@Html.DisplayFor(model => model.People.Birthplace)</dd>
                }

                @if (Model.People.Height != null && Model.People.Height > 50)
                {
                    <dt>@Html.DisplayNameFor(model => model.People.Height)</dt>
                    <dd>@Html.DisplayFor(model => model.People.Height)</dd>
                }

            </dl>
        </div>

        <!--BIOGRAFIA-->
        <div class="panel-group col-xs-11 nopadding">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" href="#coll_description" class="panel-link">@Html.DisplayNameFor(model => model.People.Biography)</a>
                    </h4>
                </div>
                <div id="coll_description" class="panel-collapse collapse @coll_biography_in">
                    <div class="panel-body">
                        @Html.DisplayFor(model => model.People.Biography)
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
    <!--OCENY-->
    <div class="col-xs-4 col-lg-3 rating">
        @Html.Partial("UserRatePartial", Model.LoggedInURate)
    </div>
    <div class="clearfix"></div>
</div>

<!--GALERIA-->
<div class="panel-group">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" href="#coll_gallery" class="panel-link">
                    @Html.DisplayNameFor(model => model.Photos) (@ViewBag.PhotoCount)
                </a>
            </h4>
        </div>
        <div id="coll_gallery" class="panel-collapse collapse @coll_gallery_in">
            <div class="panel-body">
                @if (Model.Photos.Count > 0)
                {
                    <div class="col-xs-12 nopadding">
                        @foreach (var photo in Model.Photos)
                        {
                            <div class="col-xs-2 moviegalery">
                                <a href='@Url.Action("Details", "Photo",new { peopleID = Model.People.PeopleID, photoID = photo.PhotoID })' data-toggle="tooltip" title="@photo.Description">
                                    <img class="img-thumbnail" src="@photo.PhotoThumbURL" />
                                </a>
                            </div>
                        }
                    </div>
                    @Html.ActionLink("Zobacz całą galerię", "Index", "Photo", new { peopleID = Model.People.PeopleID }, new { @class = "btn btn-default margintop20", style = "float:right" })
                }
                else
                {
                    @:Nie dodano żadnych zdjęć :(
                }
                <div style="clear:both"></div>
            </div>
        </div>
    </div>

</div>


<!--ROLE FILMOWE-->
@if (Model.People.Proffesion.Actor == true)
{
    <div class="panel-group">
        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="col-xs-11 nopadding" style=@padding>
                    <h4 class="panel-title">
                        <a data-toggle="collapse" href="#coll_cast" class="panel-link">
                            Gra aktorska
                        </a>
                    </h4>
                </div>
                <div class="col-xs-1">
                    @if ((User.IsInRole("User") || User.IsInRole("Admin")) && Model.Cast.Count != 0)
                    {
                        <button type="button" class="btn btn-default" onclick="UnHide()">
                            <i class="glyphicon glyphicon-menu-down"></i>
                        </button>
                    }
                </div>
                <div class="clearfix"></div>
            </div>
            <div id="coll_cast" class="panel-collapse collapse @coll_cast_in">
                <div class="panel-body">
                    @if (Model.Cast.Count != 0)
                    {
                        bool first = true;
                        int lastproductionyear = 0;
                        foreach (var cast in Model.Cast)
                        {
                            <div class="cast row">
                                <div class="col-xs-1 col-md-offset-1">
                                    @if (lastproductionyear != cast.Movie.ProductionYear)
                                    {
                                        @cast.Movie.ProductionYear
                                        lastproductionyear = cast.Movie.ProductionYear;
                                    }
                                </div>
                                <div class="poster col-xs-2">
                                    <a href=@Url.Action("Details", "Movies", new { id = cast.MovieID })>
                                        @if (cast.Movie.Poster != null)
                                        {
                                            <img class="img-responsive poster" src="@Url.Action("GetImage", "Movies", new { cast.MovieID })" />
                                        }
                                        else
                                        {
                                            <img class="img-responsive poster" src="~/Images/Brak_zdjecia.png" />
                                        }
                                    </a>
                                </div>
                                <div class="col-xs-3">
                                    @Html.ActionLink(Html.DisplayFor(modelItem => cast.Movie.Title).ToString(), "Details", "Movies", new { id = cast.MovieID }, null)
                                    <br />
                                    @Html.DisplayFor(modelitem => cast.Movie.TitlePL)
                                </div>
                                <div class="col-xs-1">
                                    @if (first == true)
                                    {
                                        @:jako:
                                        first = false;
                                    }
                                </div>
                                <div class="col-xs-2">
                                    @Html.DisplayFor(modelitem => cast.RoleName)
                                    @if (cast.Dubbing == true)
                                    {
                                        <br />
                                        @:(dubbing)
                                    }
                                </div>
                                <!--
                                                <div class="poster col-xs-2">
                                                    ZDJECIE ROLI
                                <img class="img-responsive poster" src="~/Images/Brak_zdjecia.png" />
                                                </div>-->
                                <div class="col-xs-2" name="editcast" style="display:none">
                                    @Html.ActionLink("Edytuj", "Edit", "ActorRoles", new { id = cast.ActorRoleID, ispeople = true }, new { @class = "btn btn-default" })
                                    @Html.ActionLink("Usuń", "Delete", "ActorRoles", new { id = cast.ActorRoleID, ispeople = true }, new { data_toggle = "tooltip", title = "Tylko moderator może usuwać role!", @class = @deleteclass + " btn btn-default" })
                                </div>
                            </div>
                        }


                    }
                    else
                    {
                        @:Brak występów w filmach :(
                    }
                    @if (User.IsInRole("User") || User.IsInRole("Admin"))
                    {
                        @Html.ActionLink("Dodaj członka obsady", "Create", "ActorRoles", new { peopleID = Model.People.PeopleID }, new { @class = "btn btn-default", style = "float:right" })
                    }
                </div>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
}

<!--REŻYSERKA-->
@if (Model.People.Proffesion.Director == true)
{
    <div class="panel-group">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" href="#coll_dir" class="panel-link">
                        Reżyseria
                    </a>
                </h4>
            </div>
            <div id="coll_dir" class="panel-collapse collapse @coll_director_in">
                <div class="panel-body">
                    @if (Model.DirectedMovies.Count != 0)
                    {
                        int lastproductionyear = 0;
                        foreach (var movie in Model.DirectedMovies)
                        {
                            <div class="cast row">
                                <div class="col-xs-1 col-md-offset-1">
                                    @if (lastproductionyear != movie.ProductionYear)
                                    {
                                        @movie.ProductionYear
                                        lastproductionyear = movie.ProductionYear;
                                    }
                                </div>
                                <div class="poster col-xs-2">
                                    @if (movie.Poster != null)
                                    {

                                        <img class="img-responsive poster" src="@Url.Action("GetImage", "Movies", new { movie.MovieID })" />

                                    }
                                    else
                                    {
                                        <img class="img-responsive poster" src="~/Images/Brak_zdjecia.png" />
                                    }
                                </div>
                                <div class="col-xs-2">
                                    @Html.ActionLink(Html.DisplayFor(modelItem => movie.Title).ToString(), "Details", "Movies", new { id = movie.MovieID }, null)
                                    <br />
                                    @Html.DisplayFor(modelitem => movie.TitlePL)
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        @:Brak wyreżyserowanych filmów :(
                    }
                </div>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
}


<button class="btn btn-default">
    @Html.ActionLink("Powrót", "Index", null, new { @class = "nodecoration" })
</button>

@section Scripts {
    @Scripts.Render("~/bundles/MyFunctions")
}
